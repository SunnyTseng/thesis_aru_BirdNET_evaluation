mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess),
TP_cum = n_cum * rate_loess,
FP_cum = n_cum * (1 - rate_loess))
View(rate_loess_count)
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
# group_by(common_name) %>%
# mutate(n_cum = revcumsum(n)/sum(n)*100) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess)) %>%
group_by(common_name) %>%
mutate(TP_cum = revcumsum(TP)/sum(TP)*100,
FP_cum = TP_cum = revcumsum(FP)/sum(FP)*100)
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
# group_by(common_name) %>%
# mutate(n_cum = revcumsum(n)/sum(n)*100) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess)) %>%
group_by(common_name) %>%
mutate(TP_cum = revcumsum(TP)/sum(TP)*100,
FP_cum = revcumsum(FP)/sum(FP)*100)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
(g1_list$g1[[1]] | g1_list$g1[[2]] | g1_list$g1[[3]]) /
(g1_list$g1[[4]] | g1_list$g1[[5]] | g1_list$g1[[6]])
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
# group_by(common_name) %>%
# mutate(n_cum = revcumsum(n)/sum(n)*100) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess)) %>%
group_by(common_name) %>%
mutate(TP_cum = revcumsum(TP)/sum(TP)*100,
FP_cum = revcumsum(FP)/sum(FP)*100)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
# group_by(common_name) %>%
# mutate(n_cum = revcumsum(n)/sum(n)*100) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess)) %>%
group_by(common_name) %>%
mutate(TP_cum = revcumsum(TP)/sum(n)*100,
FP_cum = revcumsum(FP)/sum(n)*100)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
library(tidyverse)
library(data.table)
library(here)
library(spatstat.utils)
library(patchwork)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
library(RColorBrewer)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
(g1_list$g1[[1]] | g1_list$g1[[2]] | g1_list$g1[[3]]) /
(g1_list$g1[[4]] | g1_list$g1[[5]] | g1_list$g1[[6]])
(g1_list$g1[[7]] | g1_list$g1[[8]] | g1_list$g1[[9]]) /
(g1_list$g1[[10]] | g1_list$g1[[11]] | g1_list$g1[[12]])
(g1_list$g1[[13]] | g1_list$g1[[14]] | g1_list$g1[[15]]) /
(g1_list$g1[[16]] | g1_list$g1[[17]] | g1_list$g1[[18]])
g1_list$g1[[19]]
(g1_list$g1[[13]] | g1_list$g1[[14]] | g1_list$g1[[15]]) /
(g1_list$g1[[16]] | g1_list$g1[[17]] | g1_list$g1[[18]])
g1_list$g1[[19]]
g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]]
g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] & xlab(NULL)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] & xlab(NULL)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] & lab(NULL)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] & xlab(NULL) & ylab(NULL)
level_patch
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] &
xlab(NULL) & ylab(NULL)
level_patch
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = rel(1), angle = 90),
plot.tag.position = "left"
)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 12, angle = 90),
plot.tag.position = "left"
)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 20, angle = 90),
plot.tag.position = "left"
)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] &
xlab(NULL) & ylab(NULL) & theme(plot.margin = margin(5.5, 5.5, 5.5, 0)) +
plot_annotation(tag_levels = 'A')
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] &
xlab(NULL) & ylab(NULL) & theme(plot.margin = margin(5.5, 5.5, 5.5, 0))
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]]
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A')
level_patch
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] &
xlab(NULL) & ylab(NULL) +
plot_annotation(tag_levels = 'A')
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 0))
level_patch
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 0)) &
xlab(NULL)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 0)) &
xlab(NULL) &
ylab(NULL)
level_patch
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 0.5)) &
xlab(NULL) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 1.5)) &
xlab(NULL) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 3.5)) &
xlab(NULL) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
xlab(NULL) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(
plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left"
)
wrap_elements(level_patch) +
labs(e = "Proportion of BirdNET detections (%)") +
theme(plot.e = element_text(size = 16, angle = 90),
plot.e.position = "left")
tag
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
level_patch <- g1_list$g1[[19]]/g1_list$g1[[7]]/g1_list$g1[[15]] +
plot_layout(design = "XYX")
level_patch <- g1_list$g1[[19]] + g1_list$g1[[7]] + g1_list$g1[[15]] +
plot_layout(design = "XYX")
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
xlab(NULL) &
ylab(NULL)
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85),
title = element_text(size = 14))
return(g1)
}
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess)) %>%
group_by(common_name) %>%
mutate(TP_cum = revcumsum(TP)/sum(n)*100,
FP_cum = revcumsum(FP)/sum(n)*100)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.80),
title = element_text(size = 14))
return(g1)
}
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess)) %>%
group_by(common_name) %>%
mutate(TP_cum = revcumsum(TP)/sum(n)*100,
FP_cum = revcumsum(FP)/sum(n)*100)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.70),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
g1_list$g1[[19]]
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] &
# plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
(g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[15]] | g1_list$g1[[2]])
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
level_patch
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.7, 0.80),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.75, 0.80),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.80, 0.80),
title = element_text(size = 14))
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.80, 0.80),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
