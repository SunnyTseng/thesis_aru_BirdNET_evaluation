scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.80),
title = element_text(size = 14))
return(g1)
}
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess)) %>%
group_by(common_name) %>%
mutate(TP_cum = revcumsum(TP)/sum(n)*100,
FP_cum = revcumsum(FP)/sum(n)*100)
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.70),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
g1_list$g1[[19]]
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] +
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
level_patch <- g1_list$g1[[19]] / g1_list$g1[[7]] / g1_list$g1[[15]] &
# plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
(g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[15]] | g1_list$g1[[2]])
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
level_patch
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.7, 0.80),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.75, 0.80),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.80, 0.80),
title = element_text(size = 14))
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.80, 0.80),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
level_patch <- (g1_list$g1[[19]] | g1_list$g1[[7]]) / (g1_list$g1[[2]] | g1_list$g1[[15]]) &
plot_annotation(tag_levels = 'A') &
theme(plot.margin = margin(5.5, 5.5, 5.5, 5.5)) &
ylab(NULL)
wrap_elements(level_patch) +
labs(tag = "Proportion of BirdNET detections (%)") +
theme(plot.tag = element_text(size = 16, angle = 90),
plot.tag.position = "left")
###
### Library
###
library(tidyverse)
library(here)
data_2020 <- read_csv(here("data", "processed", "2020_passerine_BirdNET.csv"))
data_2021 <- read_csv(here("data", "processed", "2021_passerine_BirdNET.csv"))
data_all <- bind_rows(data_2020, data_2021) %>%
mutate(category = cut(x = confidence, breaks = seq(0.1, 1, 0.05)))
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
dir <- "E:/Audio/2021_passerine"
dataset <- read_csv(here("data", "number_evaluation", "Olive-sided Flycatcher_working.csv"))
library(tidyverse)
library(here)
# import data
data_2020 <- read_csv(here("data", "processed", paste0(2020, "_passerine_BirdNET_updated.csv")))
data_2021 <- read_csv(here("data", "processed", paste0(2021, "_passerine_BirdNET.csv")))
View(data_2020)
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
dir <- "E:/Audio"
dataset <- read_csv(here("data", "number_evaluation", "Varied Thrush_working.csv"))
i <- 1
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
range <- 1:100
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 101:200
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 201:300
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 301:400
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 401:500
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 501:600
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
dir <- "E:/Audio"
dataset <- read_csv(here("data", "number_evaluation", "Varied Thrush_working.csv"))
range <- 601:700
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 701:800
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 801:900
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
rm(list = ls())
library(seewave)
library(tuneR)
library(tidyverse)
library(here)
dir <- "E:/Audio"
dataset <- read_csv(here("data", "number_evaluation", "Yellow_rumped Warbler_working.csv"))
range <- 1:100
dataset <- read_csv(here("data", "number_evaluation", "Yellow_rumped Warbler_working.csv"))
range <- 1:100
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 101:200
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 201:300
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 301:400
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 401:500
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 501:600
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 601:700
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 701:800
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
range <- 801:900
for (i in range) {
year <- dataset$year[i]
site <- dataset$site[i]
recording <- dataset$recording[i]
start_s <- dataset$start_s[i]
end_s <- dataset$end_s[i]
song <- readWave(paste0(dir, "/", year, "_passerine", "/", site, "/", recording, ".wav"),
from = start_s - 1,
to = end_s + 1,
units = "seconds")
print(paste0("This is recording ", recording, " from ", start_s, " to ", end_s))
play(song, ... = "/play /close")
}
