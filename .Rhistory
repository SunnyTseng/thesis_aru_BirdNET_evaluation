theme_bw()
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)]) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = "bottom")
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)]) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.95, 0.95))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)]) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.8, 0.8))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)]) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)]) +
scale_fill_discrete(labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_discrete(labels = c("False Positive", "True Positive")) +
scale_fill_manual(values = coul[c(6, 1)]) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_discrete(labels = c("False Positive", "True Positive"), values = coul[c(6, 1)]) +
scale_fill_manual() +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85))
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
scale_fill_discrete(labels = c("False Positive", "True Positive"), values = coul[c(6, 1)]) +
#scale_fill_manual() +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85))
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl), position = "stack", stat = "identity") +
ggtitle(species) +
#scale_fill_discrete() +
scale_fill_manual(values = coul[c(6, 1)], labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections",
fill = "Type") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "BirdNET confidence",
y = "Proportion of BirdNET detections") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85),
title = element_text(size = 14))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Threshold",
y = "Proportion of BirdNET detections") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85),
title = element_text(size = 14))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence thresholds",
y = "Proportion of BirdNET detections") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85),
title = element_text(size = 14))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85),
title = element_text(size = 14))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of total BirdNET detections") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85),
title = element_text(size = 14))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Number of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.85),
title = element_text(size = 14))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Number of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.87),
title = element_text(size = 14))
g1
g1 <- rate_loess_count %>%
filter(common_name == species) %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Number of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.9),
title = element_text(size = 14))
g1
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name)
g1_list
g1_plot <- function(data){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Number of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.9),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map(.x = data, .f =~ g1_plot(.x)))
g1_list
g1_list$g1[1]
g1_list$g1[2]
g1_list$g1[1]
g1_list$g1[2]
g1_list$g1[3]
?map2
g1_list
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Number of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.9),
title = element_text(size = 14))
return(g1)
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Number of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.9),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
g1_list
g1_list$g1[[1]]
g1_list$g1[[2]]
g1_list$g1[[3]]
g1_list$g1[[4]]
g1_list$g1[[5]]
g1_list$g1[[6]]
g1_list$g1[[7]]
g1_list$g1[[8]]
g1_list$g1[[9]]
g1_list$g1[[10]]
g1_list$g1[[11]]
g1_list$g1[[12]]
g1_list$g1[[13]]
g1_list$g1[[14]]
g1_list$g1[[15]]
g1_list$g1[[16]]
g1_list$g1[[17]]
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.9),
title = element_text(size = 14))
g1_plot <- function(data, species){
coul <- brewer.pal(10, "Set3")
g1 <- data %>%
pivot_longer(cols = c(TP_cum, FP_cum), names_to = "type") %>%
ggplot() +
geom_bar(aes(fill = type, y = value, x = category_dbl),
position = "stack",
stat = "identity") +
ggtitle(species) +
scale_fill_manual(values = coul[c(6, 1)],
labels = c("False Positive", "True Positive")) +
theme_bw() +
labs(x = "Confidence threshold",
y = "Proportion of BirdNET detections (%)") +
theme(axis.title = element_text(size = 16),
axis.text = element_text(size = 12),
legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.position = c(0.85, 0.9),
title = element_text(size = 14))
return(g1)
}
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
g1_list
library(patchwork)
library(patchwork)
g1_list$g1[[1]]
(g1_list$g1[[1]] | g1_list$g1[[2]] | g1_list$g1[[3]]) /
(g1_list$g1[[4]] | g1_list$g1[[5]] | g1_list$g1[[6]])
(g1_list$g1[[7]] | g1_list$g1[[8]] | g1_list$g1[[9]]) /
(g1_list$g1[[10]] | g1_list$g1[[11]] | g1_list$g1[[12]])
rate_loess_count <- data_all %>%
count(common_name, scientific_name, category) %>%
group_by(common_name) %>%
mutate(n_cum = revcumsum(n)/sum(n)*100) %>%
separate(col = category, into = c("from", "to"), sep = ",") %>%
mutate(from = str_extract(from, pattern = "[^\\(]+") %>% as.numeric(),
to = str_extract(to, pattern = "[^\\]]+") %>% as.numeric()) %>%
mutate(category_dbl = (from + to)/2) %>%
left_join(rate_loess) %>%
drop_na(rate_loess) %>%
mutate(TP = n * rate_loess,
FP = n * (1 - rate_loess),
TP_cum = n_cum * rate_loess,
FP_cum = n_cum * (1 - rate_loess))
g1_list <- rate_loess_count %>%
group_nest(common_name, scientific_name) %>%
mutate(g1 = map2(.x = data, .y = common_name, .f =~ g1_plot(data = .x, species = .y)))
(g1_list$g1[[1]] | g1_list$g1[[2]] | g1_list$g1[[3]]) /
(g1_list$g1[[4]] | g1_list$g1[[5]] | g1_list$g1[[6]])
(g1_list$g1[[1]] | g1_list$g1[[2]] | g1_list$g1[[3]]) /
(g1_list$g1[[4]] | g1_list$g1[[5]] | g1_list$g1[[6]])
(g1_list$g1[[7]] | g1_list$g1[[8]] | g1_list$g1[[9]]) /
(g1_list$g1[[10]] | g1_list$g1[[11]] | g1_list$g1[[12]])
(g1_list$g1[[13]] | g1_list$g1[[14]] | g1_list$g1[[15]]) /
(g1_list$g1[[16]] | g1_list$g1[[17]] | g1_list$g1[[18]])
g1_list$g1[[19]]
